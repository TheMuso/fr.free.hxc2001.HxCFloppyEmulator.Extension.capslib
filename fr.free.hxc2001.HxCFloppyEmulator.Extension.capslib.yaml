id: fr.free.hxc2001.HxCFloppyEmulator.Extension.capslib
branch: 1-19.08
runtime: fr.free.hxc2001.HxCFloppyEmulator
runtime-version: stable
sdk: org.freedesktop.Sdk//19.08
build-extension: true
separate-locales: false
appstream-compose: false
build-options:
  prefix: ${FLATPAK_DEST}
modules:
  - name: capslib
    buildsystem: simple
    build-commands: 
      - install -D apply_extra "${FLATPAK_DEST}/bin/apply_extra"
    post-install:
      - install -Dm644 --target-directory=${FLATPAK_DEST}/share/metainfo fr.free.hxc2001.HxCFloppyEmulator.Extension.capslib.metainfo.xml
      - appstream-compose --basename=fr.free.hxc2001.HxCFloppyEmulator.Extension.capslib --prefix=${FLATPAK_DEST} --origin=flatpak fr.free.hxc2001.HxCFloppyEmulator.Extension.capslib
    sources: 
      - type: script
        dest-filename: apply_extra
        commands:
          - unzip spsdeclib_source.zip
          - unzip capsimg_source_linux_macosx.zip
          - cd capsimg_source_linux_macosx/CAPSImg
          - ./configure
          - make
          - install libcapsimage.so.5.1 /app/lib/libcapsimage.so.5.1
      - type: file
        path: fr.free.hxc2001.HxCFloppyEmulator.Extension.capslib.metainfo.xml
      - type: extra-data
        url: http://www.kryoflux.com/download/spsdeclib_5.1_source.zip
        sha256: e60b756fa68c5fe073a28c618a0ec06220ef185e2a3c59e4a8d001c930f693d1
        size: 282236
        filename: spsdeclib_source.zip